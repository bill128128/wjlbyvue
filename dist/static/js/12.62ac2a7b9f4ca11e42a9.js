webpackJsonp([12],{Cdx3:function(t,e,i){var s=i("sB3e"),o=i("lktj");i("uqUo")("keys",function(){return function(t){return o(s(t))}})},Mu4U:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("fZjL"),o=i.n(s),n=i("mvHQ"),a=i.n(n),l=i("CWUh"),c=i("Au9i"),r=i("BEg3"),h=(i("mtWM"),{name:"shoppingCart",inject:["reload"],data:function(){return{selectWay1:[{value:1,title:"线上邮寄"},{value:2,title:"线下自提"}],selectWay2:[{value:3,title:"寄卖"},{value:1,title:"线上邮寄"},{value:2,title:"线下自提"}],pifaWay:[{value:1,title:"购物积分"},{value:2,title:"复购积分"}],title:"购物车",list:[],type:"",total:0,othertotol:0,sumOrder:0,info:{ptype:"",intType:1,selfLifting:1,pnumber:[],pid:"",stringPnumber:"",moduleCount:1,myCode:"点击粘贴您的复投码"},isActive:0,selectWayItemActive:0}},components:{top:l.a},created:function(){this.type=Number(this.$route.params.type),this.getContent(),this.getTotal(),2==this.type&&(this.info.selfLifting=3),this.getCheckPid()},computed:{},methods:{changeNumber:function(){var t=""+this.info.moduleCount;if(-1!=t.indexOf(".")){var e=t.split("");e.splice(e.length-1);var i=e.join("");this.info.moduleCount=+i}},pauseCode:function(){var t=this,e=window.sessionStorage.getItem("myCode");void 0==e||""==e?(this.$toast({message:"您还没有复制复投码，请到个人中心去复制"}),setTimeout(function(){t.$router.push("/myCode")},1e3)):this.info.myCode=e},changeCount:function(t){switch(t){case 1:this.info.moduleCount<=1?this.info.moduleCount=1:this.info.moduleCount--;break;case 2:this.info.moduleCount++}var e=this.checkPid();this.total=e},checkPid:function(){for(var t=0,e=this.info.moduleCount,i=0;i<this.list.length;i++){var s=parseFloat(this.list[i].score);11==this.list[i].id?s=this.sumOrder<=0&&1==e?1*s*e:this.sumOrder<=0&&e>1?2*s*e-s:2*s*e:s*=e,t+=s}return t},selectWayItem:function(t,e){this.selectWayItemActive=e,this.info.intType=t},selectWay:function(t,e){1==this.type||3==this.type?(this.info.selfLifting=t,this.isActive=e):(this.info.selfLifting=3,this.isActive=0)},getCheckPid:function(){var t=this;this.$store.dispatch("checkPid/checkPid").then(function(){200==t.$store.state.checkPid.code&&(t.sumOrder=t.$store.state.checkPid.sumOrder,console.log("sumOrder的值为："+a()(t.$store.state.checkPid.sumOrder)),t.total=t.checkPid())}).catch(function(t){console.log(t)})},gotoProductDetails:function(t){window.localStorage.setItem("pid",t),this.$router.push("/shop/productDetail")},touchin:function(t){clearInterval(this.Loop),this.Loop=setTimeout(function(){var e=this;c.MessageBox.confirm("确定删除该商品？").then(function(i){if(console.log("yes"),e.list=e.list.filter(function(e){return e.id!=t}),e.total=0,null==e.list||""==e.list||void 0==e.list);else for(var s=0;s<e.list.length;s++)e.total+=parseFloat(e.list[s].score);1==e.type?window.sessionStorage.setItem("shoppingCartRetail",a()(e.list)):2==e.type?window.sessionStorage.setItem("shoppingCartWhole",a()(e.list)):3==e.type&&window.sessionStorage.setItem("shoppingCartGift",a()(e.list)),e.$toast({message:"删除成功"}),e.getTotal()}).catch(function(){})}.bind(this),0)},getContent:function(){if(1==this.type?this.list=JSON.parse(window.sessionStorage.getItem("shoppingCartRetail")):2==this.type?this.list=JSON.parse(window.sessionStorage.getItem("shoppingCartWhole")):3==this.type&&(this.list=JSON.parse(window.sessionStorage.getItem("shoppingCartGift"))),null==this.list||""==this.list||void 0==this.list);else for(var t=0;t<this.list.length;t++)this.total+=parseFloat(this.list[t].score*this.list[t].buyCount),this.othertotol+=parseFloat(this.list[t].score*this.list[t].buyCount)},goproductdetail:function(t){this.$router.push({name:"productDetail",params:{id:t.id}}),window.localStorage.setItem("pid",t.id),window.localStorage.setItem("ptype",this.type)},isOverdue:function(){var t=this;this.$store.dispatch("isLogin/isLogin").then(function(){4e4==t.$store.state.isLogin.code&&(t.$toast({message:t.$store.state.isLogin.msg}),setInterval(function(){t.$router.push("/login")},2e3),window.localStorage.removeItem("date"))}).catch(function(t){console.log(t)})},buy:function(){var t=this;if(this.isOverdue(),0==this.total)return this.$toast({message:"您没有需要支付的商品"}),!1;switch(console.log("信息",this.info),console.log("商城类型",this.type),this.type){case 1:if(console.log("零售商城"),3e3!=this.total)return this.$toast({message:"商品总额必须为3000分"}),!1;switch(this.info.selfLifting){case 2:console.log("线下"),this.pinInfo(),console.log(this.info),this.$messagebox.confirm("是否确认下单?").then(function(e){t.$Indicator.open("下单中"),t.$store.dispatch("shoppingCart/downlineBuy",[t.info,t.type]).then(function(){var e=t.$store.state.shoppingCart.downlineBuy.msg;200==t.$store.state.shoppingCart.downlineBuy.code?(window.sessionStorage.removeItem("shoppingCartRetail"),t.$Indicator.close(),t.reload(),t.$toast({message:e})):t.$toast({message:e})}).catch(function(t){console.log(t)})}).catch(function(){});break;case 1:this.pinInfo();var e=window.sessionStorage.setItem("retailShoppingProduct",a()(this.info));this.$router.push({name:"makeSureOrder",params:{proInfo:e}})}break;case 2:if(console.log(this.total),3e3==this.total);else switch(this.info.intType){case 1:return this.$toast({message:"商品总额必须是600购物积分+600购物券"}),!1;case 2:return this.$toast({message:"商品总额必须是1200复购积分"}),!1}if(2==this.info.intType&&"点击粘贴您的复投码"==this.info.myCode)return this.$toast({message:"请粘贴您的复投码"}),!1;switch(this.info.selfLifting){case 1:this.pinInfo();window.sessionStorage.setItem("wholeShoppingProduct",a()(this.info));this.$router.push({name:"makeSureOrder"});break;case 2:this.pinInfo(),this.$messagebox.confirm("是否确认下单?").then(function(e){t.$Indicator.open("下单中"),t.$store.dispatch("shoppingCart/wholeDownlineBuy",[t.info,t.type]).then(function(){var e=t.$store.state.shoppingCart.wholeDownlineBuy.msg;200==t.$store.state.shoppingCart.wholeDownlineBuy.code?(t.$Indicator.close(),window.sessionStorage.removeItem("shoppingCartWhole"),t.reload(),t.$toast({message:e})):t.$toast({message:e})}).catch(function(t){console.log(t)})}).catch(function(){});break;case 3:this.pinInfo(),this.$messagebox.confirm("是否确认下单?").then(function(e){t.$Indicator.open("下单中"),t.$store.dispatch("shoppingCart/sell",[t.info,t.type]).then(function(){var e=t.$store.state.shoppingCart.sell.msg;200==t.$store.state.shoppingCart.sell.code?(t.$Indicator.close(),window.sessionStorage.removeItem("shoppingCartWhole"),t.reload(),t.$toast({message:e})):t.$toast({message:e})}).catch(function(t){console.log(t)})}).catch(function(){})}break;case 3:switch(this.info.selfLifting){case 1:this.pinInfo();var i=window.sessionStorage.setItem("giftShoppingProduct",a()(this.info));this.$router.push({name:"makeSureOrder",params:{proInfo:i}});break;case 2:this.pinInfo(),console.log(this.info),this.$messagebox.confirm("是否确认下单?").then(function(e){t.$indicator.open("下单中");var i=window.localStorage.getItem("date");t.$axios.post(r.a+"/finance/Giftpay/PlaceUnderOrder",{accessToken:i,id:t.info.pid,type:t.info.ptype,number:t.info.stringPnumber,self_lifting:t.info.selfLifting,or_number:t.info.moduleCount}).then(function(e){t.$indicator.close(),200==e.data.code&&(window.sessionStorage.removeItem("shoppingCartGift"),t.reload()),t.$toast(e.data.msg)}).catch(function(t){console.log(t)})}).catch(function(){})}}},getTotal:function(){if(this.total=0,null==this.list||""==this.list||void 0==this.list);else for(var t=0;t<this.list.length;t++)this.total+=parseFloat(this.list[t].score*this.list[t].buyCount)},pinInfo:function(){this.info.pnumber=[],this.info.pid=[],this.info.result=[],this.info.stringPnumber="";for(var t=0;t<this.list.length;t++){for(var e=0;e<this.info.pid.length;e++)this.info.pid[t],this.list[t].id;this.info.pid.push(this.list[t].id);var i={};this.$set(i,this.list[t].id,this.list[t].buyCount),this.info.pnumber.push(i)}for(var s=0;s<this.info.pnumber.length;s++)this.info.result.push(o()(this.info.pnumber[s])+":"+this.info.pnumber[s][o()(this.info.pnumber[s])]);this.info.stringPnumber=this.info.result.join(","),this.info.ptype=this.type,this.info.total=this.total,window.localStorage.setItem("ptype",this.type)}}}),u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"shoppingCart"}},[i("top",{attrs:{message:t.title}}),t._v(" "),i("div",{staticClass:"container"},[i("ul",{staticClass:"coversionRecordList"},t._l(t.list,function(e){return i("li",{staticClass:"coversionRecordItem",on:{click:function(i){i.preventDefault(),t.goproductdetail(e)}}},[i("div",{staticClass:"item2"},[i("img",{attrs:{src:e.img[0],alt:""}}),t._v(" "),i("ul",{staticClass:"goodsList"},[i("li",{staticClass:"total"},[1==t.type?[i("span",[t._v("￥"+t._s(e.score)+" ")]),t._v("购物积分\n                                ")]:t._e(),t._v(" "),2==t.type?[i("span",[t._v(t._s(e.score))]),t._v("购物积分\n                                ")]:t._e(),t._v(" "),3==t.type?[i("span",[t._v("￥"+t._s(e.score)+" ")]),t._v("礼品积分\n                                ")]:t._e()],2),t._v(" "),i("li",[t._v(t._s(e.title))]),t._v(" "),i("li",{staticClass:"deleteBtn"},[i("span",[t._v("共"+t._s(e.buyCount)+"件商品")]),t._v(" "),i("span",{staticClass:"btn",on:{click:function(i){i.stopPropagation(),t.touchin(e.id)}}},[t._v("删除")])])])])])}))]),t._v(" "),i("div",{staticClass:"buy"},[i("div",{staticClass:"buyContent"},[1==this.type?i("div",[i("span",[t._v("总计 : "+t._s(this.total)+"购物积分")])]):t._e(),t._v(" "),2==this.type?i("div",[1==this.info.intType?i("span",[t._v("总计 : "+t._s(this.total/10*2)+"购物卷 + "+t._s(this.total/10*2)+"购物积分")]):t._e(),t._v(" "),2==this.info.intType?i("span",[t._v("总计 : "+t._s(this.total/10*2*2)+"复购积分")]):t._e()]):t._e(),t._v(" "),3==this.type?i("div",[i("span",[t._v("总计 : "+t._s(this.total)+"礼品积分")])]):t._e()]),t._v(" "),i("div",{staticClass:"countBox"},[i("div",{staticStyle:{color:"#FFBB33","font-size":".37rem"}},[t._v("倍数：")]),t._v(" "),i("span",{on:{click:function(e){t.changeCount(1)}}},[t._v("-")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.info.moduleCount,expression:"info.moduleCount"}],staticClass:"countBoxNum",attrs:{type:"number",min:"0"},domProps:{value:t.info.moduleCount},on:{keyup:t.changeNumber,input:function(e){e.target.composing||t.$set(t.info,"moduleCount",e.target.value)}}}),t._v(" "),i("span",{on:{click:function(e){t.changeCount(2)}}},[t._v("+")])]),t._v(" "),i("div",{staticClass:"selectBox"},[2==t.type?i("div",{staticClass:"selectWay"},[t._l(t.pifaWay,function(e,s){return i("div",{key:s,staticClass:"selectWayItem",class:{active:t.selectWayItemActive==s},on:{click:function(i){t.selectWayItem(e.value,s)}}},[t._v(t._s(e.title))])}),t._v(" "),1==t.selectWayItemActive?i("div",{staticClass:"codeBox",on:{click:t.pauseCode}},[t._v(t._s(t.info.myCode))]):t._e()],2):t._e(),t._v(" "),i("div",{staticClass:"selectWay"},[t._l(t.selectWay1,function(e,s){return 1==t.type||3==t.type?i("div",{key:s,staticClass:"buyWay",class:{active:t.isActive==s},on:{click:function(i){t.selectWay(e.value,s)}}},[t._v(t._s(e.title))]):t._e()}),t._v(" "),t._l(t.selectWay2,function(e,s){return 2==t.type?i("div",{key:s,staticClass:"buyWay",class:{active:t.isActive==s},on:{click:function(i){t.selectWay(e.value,s)}}},[t._v(t._s(e.title))]):t._e()})],2)]),t._v(" "),i("div",{staticClass:"buyButton",staticStyle:{padding:".2rem .4rem .4rem",display:"flex","justify-content":"center"}},[i("span",{staticClass:"buyBtn",staticStyle:{"flex-grow":"1"},on:{click:function(e){t.buy()}}},[t._v("结算")])])])],1)},staticRenderFns:[]};var p=i("VU/8")(h,u,!1,function(t){i("Y6F3")},"data-v-94d3d2b6",null);e.default=p.exports},Y6F3:function(t,e){},fZjL:function(t,e,i){t.exports={default:i("jFbC"),__esModule:!0}},jFbC:function(t,e,i){i("Cdx3"),t.exports=i("FeBl").Object.keys},uqUo:function(t,e,i){var s=i("kM2E"),o=i("FeBl"),n=i("S82l");t.exports=function(t,e){var i=(o.Object||{})[t]||Object[t],a={};a[t]=e(i),s(s.S+s.F*n(function(){i(1)}),"Object",a)}}});